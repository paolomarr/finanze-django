{% extends 'movimenti/base.html' %}
{% load static %}
{% block extra_script %}
{{ block.super }}
<script type="text/javascript" src="{% static 'movimenti/summary.js' %}"></script>
{% endblock %}

{% block title %}
Movimenti dal {{ start }} al {{ end }}
{% endblock %}
{% block content %}
<div id="select-period">
	<form class="row row-cols-lg-auto g-3 align-items-center">
		<div class="col-12">
			<div class="form-floating">
				<select class="form-select" name="month" id="select-month">
					<option value="1">January</option>
					<option value="2">February</option>
					<option value="3">March</option>
					<option value="4">April</option>
					<option value="5">May</option>
					<option value="6">June</option>
					<option value="7">July</option>
					<option value="8">August</option>
					<option value="9">September</option>
					<option value="10">October</option>
					<option value="11">November</option>
					<option value="12">December</option>
				</select>
				<label for="select-month">Month</label>
			</div>
		</div>
		<div class="col-12">
			<div class="form-floating">
				<select class="form-select" name="year" id="select-year">
					{% for year in availableYears %}
					<option value="{{year|date:'Y'}}">{{year |date:'Y'}}</option>
					{% endfor %}
				</select>
				<label for="select-year">Year</label>
			</div>
		</div>
		<div class="col-12">
			<button type="button" class="btn btn-primary" onclick="selectDate()">Select</button>
		</div>
	</form>
</div>
<h2>Movimenti dal {{ start | date:'d/m/Y' }} al {{ end | date:'d/m/Y' }}</h2>
<table>
	<thead>
		<th>Category</th>
		<th>Incomes</th>
		<th>Expenses</th>
	</thead>
	<tbody>
		{% for res in results %}
		{% if res.ins.amount > 0 or res.outs.amount > 0 %}
		<tr>
			<td><a href="#" data-category="{{res.cat.id}}">{{res.cat.category}}</a></td>
			<td class="currency">{{res.ins.amount | floatformat:2}}</td>
			<td class="currency">{{res.outs.amount | floatformat:2}}</td>
		</tr>
		{% endif %}
		{% endfor %}
		<tr class="table-total">
			<td></td>
			<td class="currency">{{ totals.ins |floatformat:2 }}</td>
			<td class="currency">{{ totals.outs |floatformat:2 }}</td>
		</tr>
	</tbody>
</table>
<script type="text/javascript">
	// window.location.search = "?year={{start | date:'Y'}}&month={{start | date:'m'}}"
	$('#select-month').val({{start | date:'m'}});
	$('#select-year').val({{start | date:'Y'}});
</script>
{% endblock %}