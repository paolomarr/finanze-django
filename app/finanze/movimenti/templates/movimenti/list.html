{% extends 'movimenti/base.html' %}
{% load static %}
{% block title %}
Lista movimenti
{% endblock %}
{% block extra_script %}
{{ block.super }}
<script type="text/javascript" src="{% static 'movimenti/list.js' %}"></script>
{% endblock %}
{% block content %}
<div class="pagination">
	<span class="step-links">
		{% if page_obj.has_previous %}
		<a href="?page=1">&laquo; first</a>
		<a href="?page={{ page_obj.previous_page_number }}">previous</a>
		{% endif %}

		<span class="current">
			Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
		</span>

		{% if page_obj.has_next %}
		<a href="?page={{ page_obj.next_page_number }}">next</a>
		<a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
		{% endif %}
	</span>
</div>
<div>
	<button class="btn btn-secondary" type="button" onclick="cleanFilters()">Clear filters</button>
</div>
<div class="table-container">
	<div class="row">
		<div class="col-12 offset-lg-1 col-lg-4">
			<input class="form-control" type="text" id="filter-description" placeholder="Filter description..." onchange="applyFilter()" />
		</div>
		<div class="col-12 offset-lg-1 col-lg-3">
			<select class="form-select" id="filter-category" onchange="applyFilter()">
				<option value="-1">Filter category...</option>
			{% for cat in categories%}
				<option value="{{cat.id}}">{{cat.category}}</option>
			{% endfor %}
			</select>
		</div>
		<div class="col-12 col-lg-3">
			<select class="form-select" id="filter-subcategory" onchange="applyFilter()">
				<option value="-1">Filter subcategory...</option>
			{% for cat in subcategories%}
				<option value="{{cat.id}}">{{cat.subcategory}}</option>
			{% endfor %}
			</select>
		</div>
	</div>
	<div class="container">
		<div class="d-none d-lg-block">
			<div class="row border-bottom">
				<div class="table-header col-lg-1">Date</div>
				<div class="table-header col-lg-4">Description</div>
				<div class="table-header col-lg-1">Amount</div>
				<div class="table-header col-lg-3">Category</div>
				<div class="table-header col-lg-3">Subcategory</div>
			</div>
		</div>
			{% for mov in page_obj %}
		<div class="row border-bottom">
			<div class="col-12 col-lg-1">
				<span class="d-lg-none"><i class="bi bi-calendar-check"></i></span>
				{{mov.date | date:'d/m/Y H:i'}}
			</div>
			<div class="col-12 col-lg-4">
				<span class="d-lg-none">
					<i class="bi bi-info-square"></i>
				</span>
				{{mov.description}}</div>
			<div class="col-12 col-lg-1 currency">
				<span class="d-lg-none"><i class="bi bi-piggy-bank"></i></span>
				{{mov.amount | floatformat:2}}
			</div>
			<div class="col-12 col-lg-3">
				<span class="d-lg-none"><i class="bi bi-tag"></i></span>
				{{mov.category}}
			</div>
			<div class="col-12 col-lg-3">
				{% with subcat=mov.subcategory %}
					<span class="d-lg-none"><i class="bi bi-tags"></i></span>
				{{subcat}}
				{% endwith %}
			</div>
		</div>
			{% endfor %}
	</div>
</div>
{% endblock %}